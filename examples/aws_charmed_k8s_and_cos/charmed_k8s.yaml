series: jammy
name: charmed-kubernetes


saas:
  
  grafana-dashboards:
    url: admin/cos.grafana-dashboards
  
  
  
  prometheus-scrape:
    url: admin/cos.prometheus-scrape
  
  
  prometheus-receive-remote-write:
    url: admin/cos.prometheus-receive-remote-write
  


applications:
  calico:
    channel: stable
    charm: calico
    options:
      vxlan: Always
      cidr: 10.10.10.0/24
    bindings:
      "": internal-space
  containerd:
    channel: stable
    charm: containerd
    bindings:
      "": internal-space
  easyrsa:
    channel: stable
    charm: easyrsa
    constraints: instance-type=t2.small root-disk=50G spaces=internal-space 
    num_units: 1
    bindings:
      "": internal-space
  kubernetes-control-plane:
    channel: stable
    charm: kubernetes-control-plane
    constraints: instance-type=c6a.xlarge root-disk=400G spaces=internal-space
    num_units: 3
    options:
      service-cidr: 10.20.20.0/24
      channel: 1.28/stable
    bindings:
      "": internal-space
  etcd:
    channel: stable
    charm: etcd
    num_units: 3
    options:
      channel: 3.4/stable
    to:
    
    - kubernetes-control-plane/0
    
    - kubernetes-control-plane/1
    
    - kubernetes-control-plane/2
    
    bindings:
      "": internal-space
  kubeapi-load-balancer:
    channel: stable
    charm: kubeapi-load-balancer
    expose: true
    num_units: 3
    to:
    
    - kubernetes-control-plane/0
    
    - kubernetes-control-plane/1
    
    - kubernetes-control-plane/2
    
    bindings:
      "": internal-space
  kubernetes-worker:
    channel: stable
    charm: kubernetes-worker
    constraints: instance-type=c6a.xlarge root-disk=400G spaces=internal-space
    expose: true
    num_units: 3
    options:
      channel: 1.28/stable
    bindings:
      "": internal-space
relations:
- - kubernetes-control-plane:loadbalancer-external
  - kubeapi-load-balancer:lb-consumers
- - kubernetes-control-plane:loadbalancer-internal
  - kubeapi-load-balancer:lb-consumers
- - kubernetes-control-plane:kube-control
  - kubernetes-worker:kube-control
- - kubernetes-control-plane:certificates
  - easyrsa:client
- - etcd:certificates
  - easyrsa:client
- - kubernetes-control-plane:etcd
  - etcd:db
- - kubernetes-worker:certificates
  - easyrsa:client
- - kubeapi-load-balancer:certificates
  - easyrsa:client
- - calico:etcd
  - etcd:db
- - calico:cni
  - kubernetes-control-plane:cni
- - calico:cni
  - kubernetes-worker:cni
- - containerd:containerd
  - kubernetes-worker:container-runtime
- - containerd:containerd
  - kubernetes-control-plane:container-runtime